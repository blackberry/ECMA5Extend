(function(e,t){typeof define=="function"&&define.amd?define(t):t()})(this,function(){var e,t,n;return function(r){function i(e,t){return w.call(e,t)}function s(e,t){var n,r,i,s,o,u,a,f,l,c,h=t&&t.split("/"),p=y.map,d=p&&p["*"]||{};if(e&&e.charAt(0)===".")if(t){h=h.slice(0,h.length-1),e=h.concat(e.split("/"));for(f=0;f<e.length;f+=1){c=e[f];if(c===".")e.splice(f,1),f-=1;else if(c===".."){if(f===1&&(e[2]===".."||e[0]===".."))break;f>0&&(e.splice(f-1,2),f-=2)}}e=e.join("/")}else e.indexOf("./")===0&&(e=e.substring(2));if((h||d)&&p){n=e.split("/");for(f=n.length;f>0;f-=1){r=n.slice(0,f).join("/");if(h)for(l=h.length;l>0;l-=1){i=p[h.slice(0,l).join("/")];if(i){i=i[r];if(i){s=i,o=f;break}}}if(s)break;!u&&d&&d[r]&&(u=d[r],a=f)}!s&&u&&(s=u,o=a),s&&(n.splice(0,o,s),e=n.join("/"))}return e}function o(e,t){return function(){return p.apply(r,E.call(arguments,0).concat([e,t]))}}function u(e){return function(t){return s(t,e)}}function a(e){return function(t){m[e]=t}}function f(e){if(i(g,e)){var t=g[e];delete g[e],b[e]=!0,h.apply(r,t)}if(!i(m,e)&&!i(b,e))throw new Error("No "+e);return m[e]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function c(e){return function(){return y&&y.config&&y.config[e]||{}}}var h,p,d,v,m={},g={},y={},b={},w=Object.prototype.hasOwnProperty,E=[].slice;d=function(e,t){var n,r=l(e),i=r[0];return e=r[1],i&&(i=s(i,t),n=f(i)),i?n&&n.normalize?e=n.normalize(e,u(t)):e=s(e,t):(e=s(e,t),r=l(e),i=r[0],e=r[1],i&&(n=f(i))),{f:i?i+"!"+e:e,n:e,pr:i,p:n}},v={require:function(e){return o(e)},exports:function(e){var t=m[e];return typeof t!="undefined"?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:c(e)}}},h=function(e,t,n,s){var u,l,c,h,p,y=[],w;s=s||e;if(typeof n=="function"){t=!t.length&&n.length?["require","exports","module"]:t;for(p=0;p<t.length;p+=1){h=d(t[p],s),l=h.f;if(l==="require")y[p]=v.require(e);else if(l==="exports")y[p]=v.exports(e),w=!0;else if(l==="module")u=y[p]=v.module(e);else if(i(m,l)||i(g,l)||i(b,l))y[p]=f(l);else{if(!h.p)throw new Error(e+" missing "+l);h.p.load(h.n,o(s,!0),a(l),{}),y[p]=m[l]}}c=n.apply(m[e],y);if(e)if(u&&u.exports!==r&&u.exports!==m[e])m[e]=u.exports;else if(c!==r||!w)m[e]=c}else e&&(m[e]=n)},e=t=p=function(e,t,n,i,s){return typeof e=="string"?v[e]?v[e](t):f(d(e,t).f):(e.splice||(y=e,t.splice?(e=t,t=n,n=null):e=r),t=t||function(){},typeof n=="function"&&(n=i,i=s),i?h(r,e,t,n):setTimeout(function(){h(r,e,t,n)},4),p)},p.config=function(e){return y=e,y.deps&&p(y.deps,y.callback),p},n=function(e,t,n){t.splice||(n=t,t=[]),!i(m,e)&&!i(g,e)&&(g[e]=[e,t,n])},n.amd={jQuery:!0}}(),n("almond",function(){}),n("extend",[],function(){var e=function(e,t){var n=u(e,t);return a(e,n),f(e,n),n},t=function(e,n,r){e.__proto__&&t(e.__proto__,n,r),e.hasOwnProperty("init")&&e.init.apply(n,r)},n=function(e,t,n,r,i){Object.defineProperty(e,t,{enumerable:i?i:!1,writable:i?i:!1,configurable:!0,value:function(){return n.apply(r,arguments)}})},r=function(e,t,n,r,i){Object.defineProperty(e,t,{configurable:!0,enumerable:i?i:!1,writable:i?i:!1,value:function(){return n.apply(r,arguments)}})},i=function(e,t,n,r){var s=function(){if(arguments[0]===31415926)var e=n.apply(r,arguments[1]);else var e=n.apply(r,arguments);return s.__proto__!==i.__proto__&&(e=s.__proto__(31415926,e)),e};e[t]&&(s.__proto__=e[t]),Object.defineProperty(e,t,{configurable:!0,value:s})},s=function(e,t,n,r){var i=function(){return i.chained&&i.chained.apply(i,arguments),n.apply(r,arguments)};e[t]&&(i.chained=e[t]),Object.defineProperty(e,t,{configurable:!0,value:i})},o=function(e,t,n){var r;e[t]=n,window.__debug&&console.log("define property on "+t+" = "+n),Object.defineProperty(e.public,t,{configurable:!0,enumerable:!0,get:function(){return e[t]},set:function(r){var i=e[t];if(r===i){window.__debug&&console.log("Setting property to the same value. Ignoring");return}e[t]=r;var s=t+"Changed";e.public[s]&&e.public[s](r,i),e[s]&&e[s](r,i);if(e.public.subscribers[s]){var o=e.public.subscribers[s];_.each(o,function(e){_.isFunction(e.fn)&&e.fn(r,i)})}window.__debug&&console.log("value of "+t+" changed to "+e[t])}})},u=function(e,t){var n=e.extend?Object.create(e.extend):{};return Object.defineProperties(n,{constructor:{value:Object.create(null,{name:{enumerable:!0,value:"Class<"+t+">"}})},name:{enumerable:!0,value:t}}),n},a=function(e,t){var n=e.extend?Object.create(e.extend.prototype):{};Object.defineProperty(n,"constructor",{value:t}),Object.defineProperty(t,"prototype",{enumerable:!0,value:n})},f=function(e,t){var u=e.object.public,a=e.object.protected,f=e.object.private,l=e.object.init?e.object.init:function(){},c=e.object.destroy?e.object.destroy:function(){},h=this,p=function(){var e={};if(typeof t.__proto__.create=="function")var h=t.__proto__.create.call(this);else{var h={};Object.defineProperty(h,"public",{configurable:!0,value:Object.create(this.prototype)})}window.__debug&&console.log("CREATE "+t.name),Object.defineProperties(e,{"protected":{configurable:!0,value:h},"public":{configurable:!0,value:h.public}});for(var p in f){var d=f[p],v=typeof f[p]!="function";v?Object.defineProperty(e,p,{configurable:!0,writable:!0,value:f[p]}):Object.defineProperty(e,p,{configurable:!0,enumerable:!1,writable:!1,value:f[p]})}for(var p in a){var v=typeof a[p]!="function",d=a[p];v?Object.defineProperty(e.protected,p,{configurable:!0,enumerable:v,writable:v,value:a[p]}):r(e.protected,p,d,e)}for(var p in u){var v=typeof u[p]!="function",d=u[p];v&&d&&d.get?function(e,t,n){Object.defineProperty(e.public,t,{enumerable:n.enumerable,configurable:!0,get:function(){return n.get.apply(e)},set:function(){return n.set.apply(e,arguments)}})}(e,p,d):v?o(e,p,d):n(e.public,p,d,e,!0)}return s(h,"init",l,e),i(h,"destroy",c,e),e.public.constructor!==t?h:(Object.defineProperty(e.public,"destroy",{configurable:!0,value:function(){return h.destroy()}}),h.init.apply(h,arguments),e.public)};Object.defineProperty(t,"create",{value:p})},l={write:function(e,t,n){n.asModule(e+"!"+t,"define(['"+t+"', 'extend'],function (module, extend) { return extend.createType(module, '"+t+"' );});\n")},load:function(t,n,r,i){n([t],function(n){if(i.isBuild)return r();var s=e(n,t);r(s)})},createType:e};return l}),n("SomeType",[],function(){var e={"public":{value:null},"private":{valueChanged:function(e){console.log("value changed to "+e)}},"protected":{},init:function(){console.log("someType init")},destroy:function(){}};return{extend:null,object:e}}),n("extend!SomeType",["SomeType","extend"],function(e,t){return t.createType(e,"SomeType")}),n("main",["extend!SomeType"],function(e){var t=function(){window.newType=e.create(),newType.value="hi!"};window.addEventListener("load",t)}),t("main")});